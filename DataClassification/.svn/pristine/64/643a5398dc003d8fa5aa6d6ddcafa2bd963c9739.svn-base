select c.table_name,
    c.column_name,
   (case
    when data_type = 'CHAR'     then data_type || '(' || c.char_length || decode(char_used,'B',' BYTE','C',' CHAR',null)||')'    
    when data_type = 'VARCHAR'  then data_type || '(' || c.char_length || decode(char_used,'B',' BYTE','C',' CHAR',null)||')'    
    when data_type = 'VARCHAR2' then data_type || '(' || c.char_length || decode(char_used,'B',' BYTE','C',' CHAR',null)||')'    
    when data_type = 'NCHAR'    then data_type || '(' || c.char_length || decode(char_used,'B',' BYTE','C',' CHAR',null)||')'    
    when data_type = 'NUMBER'   then      
                                    (case when c.data_precision is null and c.data_scale is null then          'NUMBER' 
                                    when c.data_precision is null and c.data_scale is not null then          'NUMBER(38,'||c.data_scale||')' 
                                    else           data_type||'('||c.data_precision||','||c.data_SCALE||')'      end )   
    when data_type = 'NVARCHAR' then      data_type||'('||c.char_length||decode(char_used,'B',' BYTE','C',' CHAR',null)||')'    
    when data_type = 'NVARCHAR2' then     data_type||'('||c.char_length||decode(char_used,'B',' BYTE','C',' CHAR',null)||')'
    when data_type = 'LONG' then 'longish'
    
    else      data_type    end ) 
    data_type,
   
    
--    c.DATA_DEFAULT,
    column_id,
    com.comments, 
--    cols.constraint_name as "PKconstraintName",
    LISTAGG(cols.column_name,', ') within group (order by c.table_name,c.column_name,cols.constraint_name) PKconstraintName

  from 
  sys.Dba_col_comments com,
  sys.Dba_tab_Columns c 
  
  LEFT JOIN sys.all_constraints cons on (c.table_name = cons.table_name and cons.constraint_type = 'P') 
  LEFT JOIN all_cons_columns cols on (cons.constraint_name = cols.constraint_name and cons.owner= cols.owner)

  where c.owner      = 'APP_BIP'--:OBJECT_OWNER  

  and c.table_name = com.table_name
  and c.owner = com.owner
  and c.column_name = com.column_name  
  and c.table_name not like '%_V' -- remove Views
  and c.table_name like 'BIP%' --: put in the ID for the APP like PAM,TAP,PAT,BIP etc
  
group by c.table_name, c.column_name, (case when data_type = 'CHAR' then data_type || '(' || c.char_length || decode(char_used,'B',' BYTE','C',' CHAR',null)||')' when data_type = 'VARCHAR' then data_type || '(' || c.char_length || decode(char_used,'B',' BYTE','C',' CHAR',null)||')' when data_type = 'VARCHAR2' then data_type || '(' || c.char_length || decode(char_used,'B',' BYTE','C',' CHAR',null)||')' when data_type = 'NCHAR' then data_type || '(' || c.char_length || decode(char_used,'B',' BYTE','C',' CHAR',null)||')' when data_type = 'NUMBER' then (case when c.data_precision is null and c.data_scale is null then 'NUMBER' when c.data_precision is null and c.data_scale is not null then 'NUMBER(38,'||c.data_scale||')' else data_type||'('||c.data_precision||','||c.data_SCALE||')' end ) when data_type = 'NVARCHAR' then data_type||'('||c.char_length||decode(char_used,'B',' BYTE','C',' CHAR',null)||')' when data_type = 'NVARCHAR2' then data_type||'('||c.char_length||decode(char_used,'B',' BYTE','C',' CHAR',null)||')' when data_type = 'LONG' then 'longish' else data_type end ), c.char_length, 
c.data_precision, c.data_scale, decode(nullable,'Y','Yes','No'), column_id, com.comments
   order by c.table_name, column_id
