SELECT
    UPPER(SC.TABLE_NAME) AS TABLE_NAME, 
	UPPER(sc.TABLE_SCHEMA) AS [SCHEMA],
    UPPER(SC.COLUMN_NAME) AS COLUMN_NAME,
    UPPER(SC.DATA_TYPE)
        + CASE WHEN SC.DATA_TYPE IN ('char','nchar','varchar','nvarchar','binary','varbinary')
                    AND SC.CHARACTER_MAXIMUM_LENGTH > 0 THEN
                 COALESCE('('+CONVERT(varchar,SC.CHARACTER_MAXIMUM_LENGTH)+')','')
            ELSE '' END
        + CASE WHEN DATA_TYPE IN ('decimal','numeric') THEN
                COALESCE('('+CONVERT(varchar,SC.NUMERIC_PRECISION)+','+CONVERT(varchar,SC.NUMERIC_SCALE)+')','')
            ELSE '' END
        AS DATA_TYPE,
    CASE WHEN SC.IS_NULLABLE='NO' THEN 'NOT ' ELSE '' END + 'NULL' AS Nullable,

	UPPER(SC.ORDINAL_POSITION) AS COLUMN_ID,
	UPPER(SC.DOMAIN_NAME) AS COMMENTS,
	PKconstraintName  = UPPER((SELECT + Col.name + ',' + ' ' 
									    FROM  
										sys.identity_columns Col 
										WHERE 
									    --Col.Constraint_Name = TC.Constraint_Name
										object_id  = OBJECT_ID(TC.Table_Name)
										--AND TC.Constraint_Type = 'PRIMARY KEY'
										--AND COLUMNPROPERTY(object_id(TC.TABLE_NAME), col.COLUMN_NAME, 'IsIdentity') = 1
										ORDER BY Col.name DESC
										FOR XML PATH('')
										))	
FROM INFORMATION_SCHEMA.COLUMNS SC
left JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS TC ON (SC.TABLE_NAME = TC.TABLE_NAME AND TC.CONSTRAINT_TYPE = 'Primary Key')
WHERE SC.TABLE_CATALOG = 'LIS_Prd' and
UPPER(SC.TABLE_NAME) NOT LIKE 'V_%'
ORDER BY 1,2,PKconstraintName;
